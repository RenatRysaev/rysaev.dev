---
title: Используем Docker для разработки и развертывания React-приложений. Часть 1.
date: "2019-07-21"
description: Разработка React-приложений с помощью Docker.
---

##Я планирую серию статей, в которых постараюсь раскрыть следующие темы:
1) <b>Docker для разработки React-приложения</b>
2) <b>CI/CD с использованием Jenkins</b>
3) <b>Nginx для раздачи статики</b>

###Это первая часть, в которой мы разберемся с тем как настроить окружение для разработки с Docker + React

### Вступление

Все началось с того, что однажды на рабочем проекте потребовалось обновить зависимости.
После долгих мучений я наконец-то запушил свой коммит в репозиторий и отправился к нашему девопсу,
чтобы попросить задеплоить сборку из jenkins на тестовый сервер. Ну и как вы уже, наверное, догадываетесь девопсу этого сделать
не удалось, потому что на сервере с jenkins стояла node.js другой версии и закешировались старые версии библиотек.
Я бы скорее всего решил эту проблему, но на следующий рабочий день меня переводили на другой проект.

Ну собственно я к чему, используя docker, мы точно бы не имели этих проблем, и вот почему:
1) Единое окружение локально и на сервере
2) Воспроизводимость

Поэтому я решил немного раскурить Docker и поделиться полезной информацией о том
как его использовать для разработки и деплоя.  

<b>Предпологается что на вашей машине уже установлено:</b>
1) [Docker](https://www.docker.com/) v18.09.2
2) [Create React App](https://github.com/facebook/create-react-app) v3.0.1

###Создание проекта

```bash
create-react-app dockerized-react
cd dockerized-react
```

###Напишем наш Dockerfile для создания образа

```
#1
FROM node:8
#2
WORKDIR /app
#3
COPY yarn.lock /app/
COPY package.json /app/
#4
RUN yarn install
#5
EXPOSE 3000
#6
CMD ["yarn", "start"]
```

###Теперь пошагово разберемся из каких команд состоит Dockerfile:
1) В качестве родительского образа берем node.js v8
2) Установим рабочую директорию /app
3) Скопируем файлы yarn.lock и package.json в контейнер
4) Установим необходимые зависимости
5) Откроем порт 3000
6) Запускаем React-приложение после запуска контейнера

### Добавим в .dockerignore директории/файлы, которые не должны попасть в образ

```
.git
node_modules
build
```

### Создание образа

```bash
docker build -t dockerized-app .
```

### Запуск контейнера

```bash
docker run -it -v ${PWD}:/app -v /app/node_modules -p 3001:3000 -e CHOKIDAR_USEPOLLING=true dockerized-app
```

Для Windows

```bash
docker run -it -v %cd%:/app -v /app/node_modules -p 3001:3000 -e CHOKIDAR_USEPOLLING=true dockerized-app
```

<b>Давайте разберемся для чего и какие аргументы мы передаем</b>

1) "-it" - интерактивный режим
2) "-v ${PWD}:/app" - монтируем текущую рабочую директорию в директорию /app docker-контейнера
3) "-v /app/node_modules" - используем node_modules из контейнера
4) "-p" - сопоставляем порт docker-контейнера порту на хост системе
5) "-e CHOKIDAR_USEPOLLING=true" - устанавливаем переменную окружения для принудительного слежения webpack за нашим томом.

<b>Осталось открыть приложение в браузере [http://localhost:3001/](http://localhost:3001/)</b>

<b>Готово, теперь webpack отслеживает изменения файлов и изменив код в каком-либо файле мы сможем увидеть результат в браузере.</b>
