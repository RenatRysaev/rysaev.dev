{"componentChunkName":"component---src-templates-blog-post-js","path":"/react-docker/","webpackCompilationHash":"0c9b56ea196252d3cffd","result":{"data":{"site":{"siteMetadata":{"title":"Блог о веб-разработке","author":"Ренат Рысаев"}},"markdownRemark":{"id":"e931d1d4-ca9d-5206-bba5-f90e997e8672","excerpt":"Я планирую серию статей, в которых постараюсь раскрыть следующие темы: Docker для разработки React-приложения Docker для деплоя React-приложения + Nginx для…","html":"<h2>Я планирую серию статей, в которых постараюсь раскрыть следующие темы:</h2>\n<ol>\n<li><b>Docker для разработки React-приложения</b></li>\n<li><b>Docker для деплоя React-приложения + Nginx для раздачи статики</b></li>\n<li><b>Jenkins для деплоя образа React-приложения на VPS</b></li>\n</ol>\n<h3>Это первая часть, в которой мы разберемся с тем как настроить окружение для разработки с Docker + React</h3>\n<h3>Вступление</h3>\n<p>Все началось с того, что однажды на рабочем проекте потребовалось обновить зависимости.\nПосле долгой возни я наконец-то запушил свой коммит в репозиторий и отправился к админам в jenkins для того,\nчтобы попросить задеплоить сборку на тестовый сервер. Как вы уже, наверное, догадываетесь админам этого сделать\nне удалось, потому что на сервере с jenkins стояла node.js другой версии и закешировались старые версии библиотек.\nЯ бы скорее всего решил эту проблему, будь у меня доступы, но на том проекте доступ к jenkins был только у пма.  </p>\n<p>Ну собственно я к чему, если бы мы использовали docker, этих проблем мы точно бы не испытывали, потому что:</p>\n<ol>\n<li>Одинаковое окружение локально и на сервере</li>\n<li>Воспроизводимость</li>\n</ol>\n<p>Поэтому я решил немного раскурить Docker и поделиться с вами полезной информацией о том\nкак его использовать для разработки и деплоя.  </p>\n<p><b>Предпологается что на вашей уже машине установлено:</b></p>\n<ol>\n<li><a href=\"https://www.docker.com/\">Docker</a> v18.09.2</li>\n<li><a href=\"https://github.com/facebook/create-react-app\">Create React App</a> v3.0.1</li>\n</ol>\n<h3>Создание проекта</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">create-react-app dockerized-react\n<span class=\"token function\">cd</span> dockerized-react</code></pre></div>\n<h3>Напишем наш Dockerfile для создания образа</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#1\nFROM node:8\n#2\nWORKDIR /app\n#3\nCOPY yarn.lock /app/\nCOPY package.json /app/\n#4\nRUN yarn install\n#5\nEXPOSE 3000\n#6\nCMD [&quot;yarn&quot;, &quot;start&quot;]</code></pre></div>\n<h3>Теперь пошагово разберемся из каких команд состоит Dockerfile:</h3>\n<ol>\n<li>В качестве родительского образа берем node.js v8</li>\n<li>Установим рабочую директорию /app</li>\n<li>Скопируем файлы yarn.lock и package.json в контейнер</li>\n<li>Установим необходимые зависимости</li>\n<li>Откроем порт 3000</li>\n<li>Запускаем React-приложение после запуска контейнера</li>\n</ol>\n<h3>Добавим в .dockerignore директории/файлы, которые не должны попасть в образ</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.git\nnode_modules\nbuild</code></pre></div>\n<h3>Создание образа</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker build -t dockerized-app <span class=\"token keyword\">.</span></code></pre></div>\n<h3>Запуск контейнера</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker run -it -v <span class=\"token variable\">${PWD}</span>:/app -v /app/node_modules -p 3001:3000 -e CHOKIDAR_USEPOLLING<span class=\"token operator\">=</span>true dockerized-app</code></pre></div>\n<p>Для Windows</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker run -it -v %cd%:/app -v /app/node_modules -p 3001:3000 -e CHOKIDAR_USEPOLLING<span class=\"token operator\">=</span>true dockerized-app</code></pre></div>\n<p><b>Давайте разберемся для чего и какие аргументы мы передаем</b></p>\n<ol>\n<li>“-it” - интерактивный режим</li>\n<li>“-v ${PWD}:/app” - монтируем текущую рабочую директорию в директорию /app docker-контейнера</li>\n<li>“-v /app/node<em>modules” - используем node</em>modules из контейнера</li>\n<li>“-p” - сопоставляем порт docker-контейнера порту на хост системе</li>\n<li>“-e CHOKIDAR_USEPOLLING=true” - устанавливаем переменную окружения для принудительного слежения webpack за нашим томом.</li>\n</ol>\n<p><b>Осталось открыть наше приложение в браузере <a href=\"http://localhost:3001/\">http://localhost:3001/</a></b></p>\n<p><b>Готово, теперь webpack отслеживает изменения файлов и изменив код в каком-либо файле мы сможем увидеть результат в браузере.</b></p>","frontmatter":{"title":"Используем Docker для разработки и развертывания React-приложений. Часть 1.","date":"July 19, 2019","description":"Разработка React-приложений с помощью Docker."}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/react-docker/","previous":{"fields":{"slug":"/about-me/"},"frontmatter":{"title":"Знакомство"}},"next":null}}}